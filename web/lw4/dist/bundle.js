$(document).ready((()=>{$("#admAllPaintings").draggable().resizable({minHeight:300,maxHeight:500,minWidth:200,maxWidth:300}).css("border","solid 1px black"),$("#currPainting").draggable().resizable({minHeight:200,maxHeight:500,minWidth:200,maxWidth:500}).css("border","solid 1px black"),$("#stateAuction").draggable().resizable({minHeight:200,maxHeight:500,minWidth:200,maxWidth:500}).css("border","solid 1px black")})),$(document).ready((()=>{$("#currPainting").draggable().resizable({minHeight:200,maxHeight:500,minWidth:200,maxWidth:500}).css("border","solid 1px black"),$("#auction").draggable().resizable({minHeight:200,maxHeight:700,minWidth:200,maxWidth:500}).css("border","solid 1px black")})),(()=>{let t=io();function e(t){$("#currPainting").empty(),$("#currPainting").prepend($("<img>",{src:t.imgName,width:150})),$("#currPainting").append("<p>Название:"+t.title+"<p>Стартовая цена:"+t.startPrice+"</p>Шаг:"+t.minStep+"-"+t.maxStep),$("#spinner").attr({max:t.maxStep,min:t.minStep,step:1e3})}function i(){t.emit("startSale")}function a(e){t.emit("nextPainting",{currImgId:e,owner:window.lastBetId})}t.on("connect",(()=>{t.emit("hello",{name:$("#personName").val()})})),t.on("smbdConnect",(t=>{$("#stateAuction").append("<p>"+t.msg)})),t.on("start",(t=>{$("#submitBet").prop("disabled",!0);let a=t.picture;console.log("must starting"),console.log("pict = ",a.imgName),$("#timeFromStart").show(),e(a),$("#submitBet").prop("disabled",!1),$("#stateAuction").append("<p><strong> Начало аукциона! </strong> Время на изучение картины</p>");let n=1;window.timeFromStart=setInterval((()=>{$("#timeFromStart").text("Время с начала аукциона: "+n+"сек"),n++}),1e3),"admin"===$("#personName").val()&&setTimeout(i,1e3*t.settings[0].pause)})),t.on("startSale",(t=>{$("#stateAuction").append("<p>Начало продаж</p>"),$("#submitBet").prop("disabled",!1),window.lastBetId=-1,"admin"===$("#personName").val()&&(window.timeout=setInterval((()=>{a(t.id),clearInterval(window.timeToNext),clearInterval(window.timeout)}),1e3*t.settings[0].timeout)),"admin"===$("#personName").val()&&(window.timeToNext=setTimeout(a,1e3*t.settings[0].interval,t.id))})),t.on("nextPainting",(t=>{-1!==window.lastBetId?$("#stateAuction").append("<p> Картину купил(а) "+t.members[window.lastBetId].name):$("#stateAuction").append("<p> Картину НЕ купили"),$("#stateAuction").append("<p>Следующая картина. Время на изучение.</p>"),$("#submitBet").prop("disabled",!0),e(t.picture),"admin"===$("#personName").val()&&setTimeout(i,1e3*t.settings[0].pause)})),t.on("end",(()=>{$("#currPainting").empty(),$("#submitBet").prop("disabled",!0),-1!==window.lastBetId?$("#stateAuction").append("<p> Картину купил(а) "+data.members[window.lastBetId].name):$("#stateAuction").append("<p> Картину НЕ купили"),$("#stateAuction").append("<h5>КОНЕЦ</h5>"),clearInterval(window.timeFromStart)})),t.on("bet",(t=>{console.log("bet",t),window.lastBetId=t.mem.id,$("#personId").val()===t.mem.id?$("#submitBet").prop("disabled",!0):$("#submitBet").prop("disabled",!1),$("#stateAuction").append("<p>Новая ставка: "+t.price+" от "+t.mem.name)}))})();